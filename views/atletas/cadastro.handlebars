<link rel="stylesheet" href="/css/atletas/editar.css">
<h2>Cadastro de Atleta</h2>

<form action="atletas /salvar" method="post">
    <div class="grupo">
        <div class="row">
            <div class="col">
                <!--<img class="foto" src="/Fotos/{{atleta.foto}}" alt="Sem-foto">-->
            </div>
            <div class="col col-2">
                <div class="row">
                    <div class="col">
                        <label for="codigo">Código</label>
                        <input type="text" id="codigo" name="codigo" disabled >
                    </div>
                    <div class="col">
                        <label for="nome">Nome:</label>
                        <input type="text" name="nome" id="nome">
                    </div>
                    <div class="col">
                        <label for="sexo">Sexo:</label>
                        <select name="sexo" id="sexo" >
                            <option value="MASCULINO">MASCULINO</option>
                            <option value="FEMININO">FEMININO</option>
                        </select>
                    </div>
                    <div class="col">
                        <label for="dtcadastro">Data Cadastro:</label>
                        <input type="date" name="dtcadastro" id="dtcadastro">
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <label for="rg">RG:</label>
                        <input type="text" name="rg" id="rg" >
                    </div>
                    <div class="col">
                        <label for="cpf">CPF:</label>
                        <input type="text" name="cpf" id="cpf">
                    </div>
                    <div class="col">
                        <label for="certidaonasc">Certidão Nasc.:</label>
                        <input type="text" name="certidaonasc" id="certidaonasc">
                    </div>
                    <div class="col">
                        <label for="datanasc">Data Nasc:</label>
                        <input type="date" name="datanasc" id="datanasc">
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <label for="nacionalidade">Nacionalidade:</label>
                        <input type="text" id="nacionalidade" name="nacionalidade">
                    </div>
                    <div class="col">
                        <label for="naturalidade">Natural de:</label>
                        <input type="text" id="naturalidade" name="naturalidade">
                    </div>
                    <div class="col">
                        <label for="ufnaturalidade">UF:</label>
                        <input type="text" id="ufnaturalidade" name="ufnaturalidade">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="grupo">
        <div class="row">

            <div class="col">
                <label for="endereco">Endereço:</label>
                <input type="text" id="endereco" name="endereco" >
            </div>
            <div class="col">
                <label for="numero">Nro:</label>
                <input type="text" id="numero" name="numero">
            </div>
            <div class="col">
                <label for="complemento">Complemento:</label>
                <input type="text" id="complemento" name="complemento">
            </div>
            <div class="col">
                <label for="bairro">Bairro:</label>
                <input type="text" id="bairro" name="bairro">
            </div>
            <div class="col">
                <label for="cep">CEP:</label>
                <input type="text" id="cep" name="cep">
                <i class="fas fa-search"></i>
            </div>
            <div class="col">
                <label for="cidade">Cidade:</label>
                <input type="text" id="cidade" name="cidade" >
            </div>
            <div class="col">
                <label for="uf">UF:</label>
                <input type="text" id="uf" name="uf">
            </div>
            <div class="col">
                <label for="fone">Fone:</label>
                <input type="text" id="fone" name="fone">
            </div>
            <div class="col">
                <label for="Celular">Celular:</label>
                <input type="text" id="celular" name="celular">
            </div>
            <div class="col">
                <label for="email">Email</label>
                <input type="text" id="email" name="email" >
            </div>
        </div>
    </div>
    <div class="grupo">
        <div class="row">
            <div class="col">
                <label for="estadocivil">Estado Civil:</label>
                <select name="estadocivil" id="estadocivil">
                    <option value="SOLTEIRO(A)">SOLTEIRO(A)</option>
                    <option value="CASADO(A)">CASADO(A)</option>
                    <option value="DIVORCIADO(A)">DIVORCIADO(A)</option>
                    <option value="VIUVO(A)">VIUVO(A)</option>
                    <option value="OUTRO">OUTRO</option>
                </select>
            </div>
            <div class="col">
                <label for="conjuge">Conjuge:</label>
                <input type="text" id="conjuge" name="conjuge">
            </div>
            <div class="col">
                <label for="nomemae">Nome da Mãe:</label>
                <input type="text" id="nomemae" name="nomemae" >
            </div>
            <div class="col">
                <label for="nomepai">Nome do Pai:</label>
                <input type="text" id="nomepai" name="nome">
            </div>
        </div>
    </div>
    <div class="grupo">
        <div class="row">
            <div class="col">
                <label for="tiporegistro">Tipo registro:</label>
                <select name="tiporegistro" id="tiporegistro" >
                    <option value="0">Inativo</option>
                    <option value="1">Isento</option>
                    <option value="2">Regional</option>
                    <option value="3">Vinculado</option>
                    <option value="4">Filiado</option>
                </select>
            </div>
            <div class="col">
                <label for="id_academia">Academia:</label>
                <input type="text" id="id_academia" name="id_academia">
                <span class="razao"></span>
                <i class="fas fa-search buscarAcademia"></i>
            </div>
            <div class="col">
                <label for="id_faixa">Graduação:</label>
                <select name="id_faixa" id="id_faixa">
                    <option value="0">Selecione...</option>
                    {{#each faixas }}
                    <option value={{id}}>{{nome}}</option>
                    {{/each}}
                </select>
            </div>
            <div class="col">
                <label for="dataultpromo">Última promoção:</label>
                <input type="date" name="dataultpromo" id="dataultpromo" >
            </div>
            <div class="col">
                <label for="codcbj">Cód. CBJ:</label>
                <input type="text" name="codcbj" id="codcbj">
            </div>
            <div class="col">
                <label for="cref">CREF:</label>
                <input type="text" name="cref" id="cref">
            </div>
            <div class="col">
                <label for="nome_cart">Nome Carteirinha:</label>
                <input type="text" name="nome_cart" id="nome_cart" placeholder="Nome na carteirinha...">
            </div>
        </div>
    </div>
    <div class="grupo">
        <div class="row">
            <div class="col"></div>
            <div class="col">
                <input type="submit" value="Salvar">
            </div>
        </div>
    </div>
</form>

{{!-- modal --}}
<div id="modal-academia" class="modal-container">
    <div class="modal">
        <button class="fechar">&times;</button>
        <h3 class="subtitulo">Pesquisar Academias</h3>
        <form>
            <input type="text" class="modal-input" placeholder="Código/Nome...">
            <input type="button" class="button" value="Buscar">
        </form>
        <div class="resultado"></div>
    </div>
</div>

<script>
    import { BuscarEndereco } from '/js/utils.js'

    document.getElementById('sexo').value = `{{ atleta.sexo }}`
    document.getElementById('tiporegistro').value = {{ atleta.tiporegistro }}
    document.getElementById('id_faixa').value = {{ atleta.id_faixa }}
    document.getElementById('estadocivil').value = `{{atleta.estadocivil}}`

    document.getElementById('id_academia').addEventListener('blur', async (e) => {
        let codigo = e.target.value
        const url = new URL("academias/" + codigo, window.location.origin)
        try {
            const response = await fetch(url, { method: 'get' })
            const academia = await response.json()
            document.querySelector('.razao').innerHTML = `<span class="academia">${academia.razao}</span>`
        } catch {
            alert('Código não cadastrado.')
            document.querySelector('.razao').innerHTML = `<span></span>`
        }
    })

    const modalAcademia = document.querySelector('.modal-container')
    document.querySelector('.buscarAEndereco').addEventListener('click', e => {
        modalAcademia.classList.add('mostrar')

    })

    document.querySelector('.fechar').addEventListener('click', e => {
        modalAcademia.classList.remove('mostrar')
    })
</script>